---
phase: 02-documentation-review
plan: 03
type: execute
wave: 2
depends_on: ["02-01", "02-02"]
files_modified:
  - _pkgdown.yml
autonomous: true

must_haves:
  truths:
    - "pkgdown site builds successfully without errors"
    - "Reference section groups functions logically for clinical statisticians"
    - "All internal cross-references between man pages resolve in built site"
    - "Homepage (built from README.md) renders correctly with v0.3.0 content"
  artifacts:
    - path: "_pkgdown.yml"
      provides: "Structured reference grouping for all exported functions and datasets"
  key_links:
    - from: "_pkgdown.yml reference section"
      to: "man/*.Rd"
      via: "function names matching contents entries"
    - from: "README.md"
      to: "pkgdown homepage"
      via: "pkgdown::build_site() uses README as index"
---

<objective>
Restructure _pkgdown.yml with logical reference grouping and verify the pkgdown site builds successfully with all documentation updates from Plans 01 and 02.

Purpose: DOCS-03 requirement — pkgdown site builds without errors. Additionally, restructure the reference section from default alphabetical listing to logical grouping that serves clinical statisticians.
Output: Updated _pkgdown.yml and verified pkgdown site build.
</objective>

<execution_context>
@/Users/bailliem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bailliem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-documentation-review/02-CONTEXT.md
@.planning/phases/02-documentation-review/02-RESEARCH.md
@.planning/phases/02-documentation-review/02-01-SUMMARY.md
@.planning/phases/02-documentation-review/02-02-SUMMARY.md
@_pkgdown.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restructure _pkgdown.yml with reference grouping</name>
  <files>_pkgdown.yml</files>
  <action>
    Replace the current minimal _pkgdown.yml (3 lines: url + template/bootstrap) with a structured configuration that includes reference grouping.

    Keep existing settings:
    ```yaml
    url: https://openpharma.github.io/beeca/
    template:
      bootstrap: 5
    ```

    Add a reference section using a user-task approach (Claude's discretion from CONTEXT.md). Group all exported functions and datasets. The grouping should make sense for clinical statisticians performing covariate-adjusted analyses:

    Recommended grouping (Claude has discretion to adjust):

    1. **Quick Start** — beeca_fit (streamlined workflow)
    2. **Core Analysis** — get_marginal_effect, predict_counterfactuals, average_predictions, estimate_varcov, apply_contrast (manual pipeline)
    3. **Working with Results** — print.beeca, summary.beeca, tidy.beeca, augment.beeca, plot.beeca, plot_forest (S3 methods + visualization)
    4. **Tables & Reporting** — beeca_summary_table, as_gt, beeca_to_cards_ard (output formatting)
    5. **Model Validation** — sanitize_model, sanitize_model.glm, sanitize_variable (input validation)
    6. **Datasets** — trial01, trial02_cdisc, margins_trial01, ge_macro_trial01 (example data)
    7. **Package** — beeca-package, reexports (package-level docs)

    Verify all 25+ man pages are accounted for in the reference grouping. Cross-check against `ls man/` to ensure nothing is missing. Use exact function names that match the .Rd file stems.

    Also verify the articles/vignettes section renders correctly (pkgdown auto-discovers vignettes, but check if explicit listing improves organization).
  </action>
  <verify>
    Run: `Rscript -e 'pkgdown::check_pkgdown()'` to validate _pkgdown.yml
    Verify: No warnings about missing topics or unmatched contents entries.
  </verify>
  <done>
    _pkgdown.yml has structured reference grouping with all functions and datasets accounted for. Configuration validates without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build pkgdown site and verify all cross-references resolve</name>
  <files>_pkgdown.yml</files>
  <action>
    Build the full pkgdown site and verify everything works:

    1. Run `pkgdown::build_site()` — must complete without errors
    2. Check that the reference section renders with the new grouping structure
    3. Verify the homepage (built from README.md) shows updated v0.3.0 content
    4. Check that vignettes appear in the Articles tab
    5. Verify internal cross-references (@seealso links from Plan 01) resolve to valid pages in the built site

    If build fails, diagnose and fix the issue. Common issues:
    - Function name mismatch in _pkgdown.yml contents
    - Missing man page for a referenced function
    - Broken cross-reference in roxygen2 @seealso

    The site build is the final integration test for all documentation work in this phase.
  </action>
  <verify>
    `Rscript -e 'pkgdown::build_site()'` completes with exit code 0.
    No error messages in build output.
    Built site in docs/ directory contains index.html and reference pages.
  </verify>
  <done>
    pkgdown site builds without errors. Reference section shows logical grouping. Homepage reflects v0.3.0 README. All cross-references resolve. Phase 2 documentation review is complete.
  </done>
</task>

</tasks>

<verification>
1. `Rscript -e 'pkgdown::build_site()'` completes without errors
2. `ls docs/reference/` shows all expected function reference pages
3. `docs/index.html` contains v0.3.0 content from updated README
4. Reference page groups match _pkgdown.yml structure
5. At least 3 cross-reference links verified by checking HTML output
</verification>

<success_criteria>
- pkgdown site builds successfully without errors (DOCS-03)
- Reference section organized by user task, not alphabetically
- All 25+ man pages appear in reference section
- Homepage mirrors updated README.md content
- Internal cross-references resolve correctly in built site
</success_criteria>

<output>
After completion, create `.planning/phases/02-documentation-review/02-03-SUMMARY.md`
</output>
