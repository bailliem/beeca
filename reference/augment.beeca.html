<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Augment method for beeca objects — augment.beeca • beeca</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Augment method for beeca objects — augment.beeca"><meta name="description" content="Augments the original dataset with predictions and counterfactual outcomes
from a beeca analysis. This function provides a broom-compatible interface
for accessing individual-level predictions and potential outcomes under
different treatment assignments."><meta property="og:description" content="Augments the original dataset with predictions and counterfactual outcomes
from a beeca analysis. This function provides a broom-compatible interface
for accessing individual-level predictions and potential outcomes under
different treatment assignments."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">beeca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/estimand_and_implementations.html">Introduction to estimating a marginal estimand with beeca</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Applications</h6></li>
    <li><a class="dropdown-item" href="../articles/clinical-trial-table.html">Creating Clinical Trial Tables with beeca</a></li>
    <li><a class="dropdown-item" href="../articles/ard-cards-integration.html">Integration with cards ARD Framework</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/beeca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Augment method for beeca objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/beeca/blob/main/R/augment.R" class="external-link"><code>R/augment.R</code></a></small>
      <div class="d-none name"><code>augment.beeca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Augments the original dataset with predictions and counterfactual outcomes
from a beeca analysis. This function provides a broom-compatible interface
for accessing individual-level predictions and potential outcomes under
different treatment assignments.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'beeca'</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type.predict <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  type.residuals <span class="op">=</span> <span class="st">"deviance"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a beeca object (glm object modified by <a href="get_marginal_effect.html">get_marginal_effect</a>)</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>optional dataset to augment. If NULL (default), uses the data
from the original model fit.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>deprecated. Use <code>data</code> instead.</p></dd>


<dt id="arg-type-predict">type.predict<a class="anchor" aria-label="anchor" href="#arg-type-predict"></a></dt>
<dd><p>type of prediction to include as <code>.fitted</code>. Options are
"response" (default, predicted probabilities) or "link" (linear predictor scale).</p></dd>


<dt id="arg-type-residuals">type.residuals<a class="anchor" aria-label="anchor" href="#arg-type-residuals"></a></dt>
<dd><p>type of residuals to include. Options are "deviance" (default),
"pearson", "response", or "working". Set to NULL to exclude residuals.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments (not currently used)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a tibble containing the original data augmented with:</p><table class="table table"><tr><td>.rownames</td><td>Row names from the original data (if present)</td></tr><tr><td>.fitted</td><td>Fitted values from the working model</td></tr><tr><td>.resid</td><td>Residuals (if type.residuals is not NULL)</td></tr><tr><td>.counterfactual_[level]</td><td>Predicted outcome if assigned to each treatment level</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>augment.beeca()</code> method returns the original dataset used in the
analysis, augmented with additional columns containing:</p><ul><li><p>Fitted values from the working model (<code>.fitted</code>)</p></li>
<li><p>Counterfactual predictions for each treatment level</p></li>
<li><p>Optionally, residuals and other diagnostic information</p></li>
</ul><p>This is particularly useful for:</p><ul><li><p>Examining individual predictions and potential outcomes</p></li>
<li><p>Creating plots of treatment effects across covariates</p></li>
<li><p>Conducting sensitivity analyses</p></li>
<li><p>Understanding how g-computation works at the individual level</p></li>
</ul><p>Each counterfactual column represents the predicted outcome if that
subject were assigned to a specific treatment level, holding all other
covariates constant.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_marginal_effect.html">get_marginal_effect()</a></code> for the main analysis function</p>
<p><code><a href="beeca_fit.html">beeca_fit()</a></code> for streamlined analysis pipeline</p>
<p><code><a href="predict_counterfactuals.html">predict_counterfactuals()</a></code> for the underlying prediction method</p>
<p><code><a href="tidy.beeca.html">tidy.beeca()</a></code> for tidied parameter estimates</p>
<p><code><a href="print.beeca.html">print.beeca()</a></code> for concise output</p>
<p><code><a href="summary.beeca.html">summary.beeca()</a></code> for detailed summary output</p>
<p><code><a href="plot.beeca.html">plot.beeca()</a></code> and <code><a href="plot_forest.html">plot_forest()</a></code> for visualizations</p>
<p><code><a href="as_gt.html">as_gt()</a></code> for publication-ready tables</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">trial01</span><span class="op">$</span><span class="va">trtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trial01</span><span class="op">$</span><span class="va">trtp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">aval</span> <span class="op">~</span> <span class="va">trtp</span> <span class="op">+</span> <span class="va">bl_cov</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">trial01</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="get_marginal_effect.html">get_marginal_effect</a></span><span class="op">(</span>trt <span class="op">=</span> <span class="st">"trtp"</span>, method <span class="op">=</span> <span class="st">"Ye"</span>, contrast <span class="op">=</span> <span class="st">"diff"</span>, reference <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There is 1 record omitted from the original data due to missing values, please check if they should be imputed prior to model fitting.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Augment with counterfactual predictions</span></span></span>
<span class="r-in"><span><span class="va">augmented</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">augmented</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    aval trtp  bl_cov .rownames .fitted .resid .counterfactual_0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     0 1       5.85 2           0.463 -<span style="color: #BB0000;">1.12</span>              0.533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     0 0       5.05 3           0.537 -<span style="color: #BB0000;">1.24</span>              0.537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     0 0      15.6  4           0.481 -<span style="color: #BB0000;">1.15</span>              0.481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     0 1      10.1  5           0.441 -<span style="color: #BB0000;">1.08</span>              0.510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     0 1      25.7  6           0.362 -<span style="color: #BB0000;">0.948</span>             0.428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     1 0      17.0  7           0.474  1.22              0.474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: .counterfactual_1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access counterfactual predictions for treatment level 1</span></span></span>
<span class="r-in"><span><span class="va">augmented</span><span class="op">$</span><span class="va">.counterfactual_1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 0.4634279 0.4676301 0.4127455 0.4411090 0.3621208 0.4058096 0.4208994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [8] 0.4267151 0.4449290 0.4215244 0.3907289 0.4512412 0.3894764 0.3687170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [15] 0.4622316 0.4041297 0.4183539 0.4188515 0.3402957 0.4657572 0.3916215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [22] 0.4220542 0.4674856 0.4581573 0.4435192 0.4133057 0.4270845 0.4108900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [29] 0.3829508 0.4523136 0.4650323 0.4585527 0.4152049 0.4225623 0.3928249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [36] 0.4429842 0.3957282 0.4263597 0.4141053 0.4116243 0.4519878 0.4189395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43] 0.4074387 0.4383453 0.3512238 0.4630054 0.4546930 0.4580911 0.3766422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [50] 0.4228557 0.4264304 0.3826072 0.4674416 0.3732901 0.4206740 0.4388415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 0.3603614 0.4661996 0.4272426 0.4489273 0.3797316 0.4377377 0.4236785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [64] 0.4663822 0.4197254 0.4625371 0.3687789 0.4473409 0.4202968 0.4083744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [71] 0.4152470 0.4469233 0.4499352 0.4483094 0.3836290 0.3639997 0.4262686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [78] 0.4379126 0.3650080 0.3891769 0.4356611 0.4213898 0.4593923 0.4375804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85] 0.4430570 0.3963668 0.4504229 0.4534702 0.4230941 0.4605559 0.4410356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [92] 0.4068696 0.4135581 0.4671201 0.3971339 0.4374045 0.4356424 0.3824886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [99] 0.3746329 0.4454242 0.4516408 0.4046705 0.3854636 0.4495476 0.4297727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [106] 0.3714885 0.4039131 0.3795198 0.4339617 0.4173167 0.4506223 0.4103758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [113] 0.4427342 0.4567257 0.4167769 0.4284480 0.3922526 0.4401479 0.4203372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [120] 0.4033151 0.3760781 0.4243712 0.4636694 0.4354350 0.4471726 0.4163719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127] 0.4097057 0.4167619 0.4314871 0.3712133 0.4370184 0.4273578 0.3903450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [134] 0.4552259 0.3606622 0.4516058 0.4564055 0.4176759 0.4002280 0.4386181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [141] 0.4396465 0.4385918 0.4460622 0.4318266 0.4525934 0.4207744 0.3986752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [148] 0.4066523 0.4496539 0.3718219 0.4404118 0.4108943 0.4427433 0.3526566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [155] 0.4211882 0.4454954 0.4259513 0.3879992 0.4672212 0.3829437 0.3788080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [162] 0.4002329 0.3971305 0.3946492 0.4599363 0.3233190 0.4158290 0.3972873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [169] 0.3811499 0.4015844 0.4547610 0.3674307 0.4399465 0.4409163 0.4385927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [176] 0.4549060 0.3629759 0.4119639 0.4012083 0.4216180 0.4478004 0.4495813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [183] 0.4136199 0.3886485 0.3759049 0.3977520 0.3409476 0.4674119 0.3915213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [190] 0.4076758 0.3853761 0.3721603 0.4126525 0.4551333 0.4396157 0.4537616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [197] 0.4083160 0.4384677 0.3933559 0.4175944 0.4367736 0.4358176 0.4323384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [204] 0.4519830 0.4381953 0.3892694 0.3969917 0.3869203 0.4171850 0.3869024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [211] 0.3722248 0.3379725 0.4560669 0.4077280 0.3938624 0.4581696 0.4586348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [218] 0.4001457 0.4056401 0.4439697 0.4414874 0.3874737 0.4328493 0.3809702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [225] 0.4012755 0.4197442 0.3763476 0.4275136 0.4230628 0.4515527 0.4136111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [232] 0.4385581 0.4600362 0.4537875 0.4414151 0.3589953 0.4633271 0.3862286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [239] 0.4076310 0.4138884 0.4168317 0.3767011 0.3960248 0.4648963 0.4631316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [246] 0.4252635 0.4247280 0.4595339 0.4557202 0.3396759 0.3516773 0.3721324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [253] 0.4016934 0.4551803 0.4396470 0.4153078 0.3832560 0.4262962 0.4386496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [260] 0.4329465 0.4536864 0.3831329 0.4646627 0.3838310 0.4001507 0.4117796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [267] 0.4374523</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Examine predictions by baseline covariate</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">augmented</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bl_cov</span>, y <span class="op">=</span> <span class="va">.counterfactual_1</span> <span class="op">-</span> <span class="va">.counterfactual_0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Individual Treatment Effect"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="augment.beeca-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Przybylski, Mark Baillie, Craig Wang, Dominic Magirr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

